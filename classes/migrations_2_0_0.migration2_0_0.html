<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Migration2_0_0 | SNJS Documentation - v2.0.41</title>
	<meta name="description" content="Documentation for SNJS Documentation - v2.0.41">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../assets/css/main.css">
	<script async src="../assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../assets/js/search.json" data-base="..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../index.html" class="title">SNJS Documentation - v2.0.41</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../modules.html">SNJS Documentation - v2.0.41</a>
				</li>
				<li>
					<a href="../modules/migrations_2_0_0.html">migrations/2_0_0</a>
				</li>
				<li>
					<a href="migrations_2_0_0.migration2_0_0.html">Migration2_0_0</a>
				</li>
			</ul>
			<h1>Class Migration2_0_0</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<section class="tsd-panel tsd-hierarchy">
				<h3>Hierarchy</h3>
				<ul class="tsd-hierarchy">
					<li>
						<a href="migrations_migration.migration.html" class="tsd-signature-type" data-tsd-kind="Class">Migration</a>
						<ul class="tsd-hierarchy">
							<li>
								<span class="target">Migration2_0_0</span>
							</li>
						</ul>
					</li>
				</ul>
			</section>
			<section class="tsd-panel-group tsd-index-group">
				<h2>Index</h2>
				<section class="tsd-panel tsd-index-panel">
					<div class="tsd-index-content">
						<section class="tsd-index-section ">
							<h3>Constructors</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><a href="migrations_2_0_0.migration2_0_0.html#constructor" class="tsd-kind-icon">constructor</a></li>
							</ul>
						</section>
						<section class="tsd-index-section tsd-is-private-protected">
							<h3>Properties</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#legacyreader" class="tsd-kind-icon">legacy<wbr>Reader</a></li>
								<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited tsd-is-protected"><a href="migrations_2_0_0.migration2_0_0.html#services" class="tsd-kind-icon">services</a></li>
							</ul>
						</section>
						<section class="tsd-index-section ">
							<h3>Methods</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#allplatformhelpersetstoragestructure" class="tsd-kind-icon">all<wbr>Platform<wbr>Helper<wbr>Set<wbr>Storage<wbr>Structure</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class"><a href="migrations_2_0_0.migration2_0_0.html#createdefaultitemskeyforallplatforms" class="tsd-kind-icon">create<wbr>Default<wbr>Items<wbr>Key<wbr>For<wbr>All<wbr>Platforms</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class"><a href="migrations_2_0_0.migration2_0_0.html#deletelegacystoragevalues" class="tsd-kind-icon">delete<wbr>Legacy<wbr>Storage<wbr>Values</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#getfallbackrootkeyversion" class="tsd-kind-icon">get<wbr>Fallback<wbr>Root<wbr>Key<wbr>Version</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><a href="migrations_2_0_0.migration2_0_0.html#handlestage" class="tsd-kind-icon">handle<wbr>Stage</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected"><a href="migrations_2_0_0.migration2_0_0.html#markdone" class="tsd-kind-icon">mark<wbr>Done</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#migratearbitraryrawstoragetomanagedstorageallplatforms" class="tsd-kind-icon">migrate<wbr>Arbitrary<wbr>Raw<wbr>Storage<wbr>ToManaged<wbr>Storage<wbr>All<wbr>Platforms</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#migratemobilepreferences" class="tsd-kind-icon">migrate<wbr>Mobile<wbr>Preferences</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#migratesessionstorage" class="tsd-kind-icon">migrate<wbr>Session<wbr>Storage</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class"><a href="migrations_2_0_0.migration2_0_0.html#migratestoragestructureformobile" class="tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Mobile</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#migratestoragestructureforwebdesktop" class="tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Web<wbr>Desktop</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><a href="migrations_2_0_0.migration2_0_0.html#ondone" class="tsd-kind-icon">on<wbr>Done</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected"><a href="migrations_2_0_0.migration2_0_0.html#promptforpasscodeuntilcorrect" class="tsd-kind-icon">prompt<wbr>For<wbr>Passcode<wbr>Until<wbr>Correct</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected"><a href="migrations_2_0_0.migration2_0_0.html#registerstagehandler" class="tsd-kind-icon">register<wbr>Stage<wbr>Handler</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-protected"><a href="migrations_2_0_0.migration2_0_0.html#registerstagehandlers" class="tsd-kind-icon">register<wbr>Stage<wbr>Handlers</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class"><a href="migrations_2_0_0.migration2_0_0.html#webdesktophelperencryptstorage" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Encrypt<wbr>Storage</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#webdesktophelperextractandwrapaccountkeysfromvaluestore" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Extract<wbr>And<wbr>Wrap<wbr>Account<wbr>Keys<wbr>From<wbr>Value<wbr>Store</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><a href="migrations_2_0_0.migration2_0_0.html#webdesktophelpergetpasscodekeyanddecryptencryptedstorage" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Get<wbr>Passcode<wbr>Key<wbr>And<wbr>Decrypt<wbr>Encrypted<wbr>Storage</a></li>
								<li class="tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-static"><a href="migrations_2_0_0.migration2_0_0.html#version" class="tsd-kind-icon">version</a></li>
							</ul>
						</section>
					</div>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group ">
				<h2>Constructors</h2>
				<section class="tsd-panel tsd-member tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited">
					<a name="constructor" class="tsd-anchor"></a>
					<h3>constructor</h3>
					<ul class="tsd-signatures tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited">
						<li class="tsd-signature tsd-kind-icon">new <wbr>Migration2_<wbr>0_0<span class="tsd-signature-symbol">(</span>services<span class="tsd-signature-symbol">: </span><a href="../modules/migrations_types.html#migrationservices" class="tsd-signature-type" data-tsd-kind="Type alias">MigrationServices</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="migrations_2_0_0.migration2_0_0.html" class="tsd-signature-type" data-tsd-kind="Class">Migration2_0_0</a></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#constructor">constructor</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L44">migrations/2_0_0.ts:44</a></li>
								</ul>
							</aside>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>services: <a href="../modules/migrations_types.html#migrationservices" class="tsd-signature-type" data-tsd-kind="Type alias">MigrationServices</a></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <a href="migrations_2_0_0.migration2_0_0.html" class="tsd-signature-type" data-tsd-kind="Class">Migration2_0_0</a></h4>
						</li>
					</ul>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group tsd-is-private-protected">
				<h2>Properties</h2>
				<section class="tsd-panel tsd-member tsd-kind-property tsd-parent-kind-class tsd-is-private">
					<a name="legacyreader" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> legacy<wbr>Reader</h3>
					<div class="tsd-signature tsd-kind-icon">legacy<wbr>Reader<span class="tsd-signature-symbol">:</span> <a href="migrations_readers_reader_1_0_0.storagereader1_0_0.html" class="tsd-signature-type" data-tsd-kind="Class">StorageReader1_0_0</a></div>
					<aside class="tsd-sources">
						<ul>
							<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L44">migrations/2_0_0.ts:44</a></li>
						</ul>
					</aside>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-property tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
					<a name="services" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagProtected">Protected</span> services</h3>
					<div class="tsd-signature tsd-kind-icon">services<span class="tsd-signature-symbol">:</span> <a href="../modules/migrations_types.html#migrationservices" class="tsd-signature-type" data-tsd-kind="Type alias">MigrationServices</a></div>
					<aside class="tsd-sources">
						<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#services">services</a></p>
					</aside>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group ">
				<h2>Methods</h2>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="allplatformhelpersetstoragestructure" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> all<wbr>Platform<wbr>Helper<wbr>Set<wbr>Storage<wbr>Structure</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">all<wbr>Platform<wbr>Helper<wbr>Set<wbr>Storage<wbr>Structure<span class="tsd-signature-symbol">(</span>rawStructure<span class="tsd-signature-symbol">: </span><a href="../modules/services_storage_service.html#storagevaluesobject" class="tsd-signature-type" data-tsd-kind="Type alias">StorageValuesObject</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L176">migrations/2_0_0.ts:176</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Helper
									All platforms</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>rawStructure: <a href="../modules/services_storage_service.html#storagevaluesobject" class="tsd-signature-type" data-tsd-kind="Type alias">StorageValuesObject</a></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class">
					<a name="createdefaultitemskeyforallplatforms" class="tsd-anchor"></a>
					<h3>create<wbr>Default<wbr>Items<wbr>Key<wbr>For<wbr>All<wbr>Platforms</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class">
						<li class="tsd-signature tsd-kind-icon">create<wbr>Default<wbr>Items<wbr>Key<wbr>For<wbr>All<wbr>Platforms<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L644">migrations/2_0_0.ts:644</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>All platforms
										Create new default SNItemsKey from root key.
										Otherwise, when data is loaded, we won&#39;t be able to decrypt it
										without existence of an item key. This will mean that if this migration
										is run on two different platforms for the same user, they will create
										two new items keys. Which one they use to decrypt past items and encrypt
									future items doesn&#39;t really matter.</p>
								</div>
								<dl class="tsd-comment-tags">
									<dt>access</dt>
									<dd><p>private</p>
									</dd>
								</dl>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class">
					<a name="deletelegacystoragevalues" class="tsd-anchor"></a>
					<h3>delete<wbr>Legacy<wbr>Storage<wbr>Values</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class">
						<li class="tsd-signature tsd-kind-icon">delete<wbr>Legacy<wbr>Storage<wbr>Values<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L536">migrations/2_0_0.ts:536</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>All platforms
									Deletes all StorageKey and LegacyKeys1_0_0 from root raw storage.</p>
								</div>
								<dl class="tsd-comment-tags">
									<dt>access</dt>
									<dd><p>private</p>
									</dd>
								</dl>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="getfallbackrootkeyversion" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> get<wbr>Fallback<wbr>Root<wbr>Key<wbr>Version</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">get<wbr>Fallback<wbr>Root<wbr>Key<wbr>Version<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../enums/protocol_versions.protocolversion.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ProtocolVersion</a><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L488">migrations/2_0_0.ts:488</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>If we are unable to determine a root key&#39;s version, due to missing version
										parameter from key params due to 001 or 002, we need to fallback to checking
									any encrypted payload and retrieving its version.</p>
								</div>
								<p>If we are unable to garner any meaningful information, we will default to 002.</p>
								<p>(Previously we attempted to discern version based on presence of keys.ak; if ak,
									then 003, otherwise 002. However, late versions of 002 also inluded an ak, so this
								method can&#39;t be used. This method also didn&#39;t account for 001 versions.)</p>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../enums/protocol_versions.protocolversion.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ProtocolVersion</a><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
					<a name="handlestage" class="tsd-anchor"></a>
					<h3>handle<wbr>Stage</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
						<li class="tsd-signature tsd-kind-icon">handle<wbr>Stage<span class="tsd-signature-symbol">(</span>stage<span class="tsd-signature-symbol">: </span><a href="../enums/stages.applicationstage.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ApplicationStage</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#handlestage">handleStage</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/migration.ts#L66">migrations/migration.ts:66</a></li>
								</ul>
							</aside>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>stage: <a href="../enums/stages.applicationstage.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ApplicationStage</a></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
					<a name="markdone" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagProtected">Protected</span> mark<wbr>Done</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
						<li class="tsd-signature tsd-kind-icon">mark<wbr>Done<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#markdone">markDone</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/migration.ts#L25">migrations/migration.ts:25</a></li>
								</ul>
							</aside>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="migratearbitraryrawstoragetomanagedstorageallplatforms" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> migrate<wbr>Arbitrary<wbr>Raw<wbr>Storage<wbr>ToManaged<wbr>Storage<wbr>All<wbr>Platforms</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">migrate<wbr>Arbitrary<wbr>Raw<wbr>Storage<wbr>ToManaged<wbr>Storage<wbr>All<wbr>Platforms<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L504">migrations/2_0_0.ts:504</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>All platforms
										Migrate all previously independently stored storage keys into new
									managed approach.</p>
								</div>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="migratemobilepreferences" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> migrate<wbr>Mobile<wbr>Preferences</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">migrate<wbr>Mobile<wbr>Preferences<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L561">migrations/2_0_0.ts:561</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Mobile
									Migrate mobile preferences</p>
								</div>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="migratesessionstorage" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> migrate<wbr>Session<wbr>Storage</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">migrate<wbr>Session<wbr>Storage<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L597">migrations/2_0_0.ts:597</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>All platforms
										Migrate previously stored session string token into object
										On mobile, JWTs were previously stored in storage, inside of the user object,
										but then custom-migrated to be stored in the keychain. We must account for
										both scenarios here in case a user did not perform the custom platform migration.
									On desktop/web, JWT was stored in storage.</p>
								</div>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class">
					<a name="migratestoragestructureformobile" class="tsd-anchor"></a>
					<h3>migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Mobile</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class">
						<li class="tsd-signature tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Mobile<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L309">migrations/2_0_0.ts:309</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Mobile
										On mobile legacy structure is mostly similar to new structure,
										in that the account key is encrypted with the passcode. But mobile did
										not have encrypted storage, so we simply need to transfer all existing
									storage values into new managed structure.</p>
								</div>
								<p>In version &lt;= 3.0.16 on mobile, encrypted account keys were stored in the keychain
									under <code>encryptedAccountKeys</code>. In 3.0.17 a migration was introduced that moved this value
									to storage under key <code>encrypted_account_keys</code>. We need to anticipate the keys being in
								either location.</p>
								<p>If no account but passcode only, the only thing we stored on mobile
									previously was keys.offline.pw and keys.offline.timing in the keychain
									that we compared against for valid decryption.
									In the new version, we know a passcode is correct if it can decrypt storage.
									As part of the migration, we’ll need to request the raw passcode from user,
									compare it against the keychain offline.pw value, and if correct,
								migrate storage to new structure, and encrypt with passcode key.</p>
								<p>If account only, take the value in the keychain, and rename the values
								(i.e mk &gt; masterKey).</p>
								<dl class="tsd-comment-tags">
									<dt>access</dt>
									<dd><p>private</p>
									</dd>
								</dl>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="migratestoragestructureforwebdesktop" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Web<wbr>Desktop</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Web<wbr>Desktop<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L91">migrations/2_0_0.ts:91</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Web
										Migrates legacy storage structure into new managed format.
										If encrypted storage exists, we need to first decrypt it with the passcode.
										Then extract the account key from it. Then, encrypt storage with the
										account key. Then encrypt the account key with the passcode and store it
									within the new storage format.</p>
								</div>
								<p>Generate note: We do not use the keychain if passcode is available.</p>
							</div>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
					<a name="ondone" class="tsd-anchor"></a>
					<h3>on<wbr>Done</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
						<li class="tsd-signature tsd-kind-icon">on<wbr>Done<span class="tsd-signature-symbol">(</span>callback<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#ondone">onDone</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/migration.ts#L62">migrations/migration.ts:62</a></li>
								</ul>
							</aside>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>callback: <span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">void</span></h5>
									<ul class="tsd-parameters">
										<li class="tsd-parameter-signature">
											<ul class="tsd-signatures tsd-kind-type-literal">
												<li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li>
											</ul>
											<ul class="tsd-descriptions">
												<li class="tsd-description">
													<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4>
												</li>
											</ul>
										</li>
									</ul>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
					<a name="promptforpasscodeuntilcorrect" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagProtected">Protected</span> prompt<wbr>For<wbr>Passcode<wbr>Until<wbr>Correct</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
						<li class="tsd-signature tsd-kind-icon">prompt<wbr>For<wbr>Passcode<wbr>Until<wbr>Correct<span class="tsd-signature-symbol">(</span>validationCallback<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">(</span>passcode<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">unknown</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#promptforpasscodeuntilcorrect">promptForPasscodeUntilCorrect</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/migration.ts#L30">migrations/migration.ts:30</a></li>
								</ul>
							</aside>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>validationCallback: <span class="tsd-signature-symbol">(</span>passcode<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></h5>
									<ul class="tsd-parameters">
										<li class="tsd-parameter-signature">
											<ul class="tsd-signatures tsd-kind-type-literal">
												<li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span>passcode<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></li>
											</ul>
											<ul class="tsd-descriptions">
												<li class="tsd-description">
													<h4 class="tsd-parameters-title">Parameters</h4>
													<ul class="tsd-parameters">
														<li>
															<h5>passcode: <span class="tsd-signature-type">string</span></h5>
														</li>
													</ul>
													<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></h4>
												</li>
											</ul>
										</li>
									</ul>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">unknown</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
					<a name="registerstagehandler" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagProtected">Protected</span> register<wbr>Stage<wbr>Handler</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
						<li class="tsd-signature tsd-kind-icon">register<wbr>Stage<wbr>Handler<span class="tsd-signature-symbol">(</span>stage<span class="tsd-signature-symbol">: </span><a href="../enums/stages.applicationstage.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ApplicationStage</a>, handler<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">StageHandler</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Inherited from <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#registerstagehandler">registerStageHandler</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/migration.ts#L21">migrations/migration.ts:21</a></li>
								</ul>
							</aside>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>stage: <a href="../enums/stages.applicationstage.html" class="tsd-signature-type" data-tsd-kind="Enumeration">ApplicationStage</a></h5>
								</li>
								<li>
									<h5>handler: <span class="tsd-signature-type">StageHandler</span></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-protected">
					<a name="registerstagehandlers" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagProtected">Protected</span> register<wbr>Stage<wbr>Handlers</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-protected">
						<li class="tsd-signature tsd-kind-icon">register<wbr>Stage<wbr>Handlers<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Overrides <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#registerstagehandlers">registerStageHandlers</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L59">migrations/2_0_0.ts:59</a></li>
								</ul>
							</aside>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class">
					<a name="webdesktophelperencryptstorage" class="tsd-anchor"></a>
					<h3>web<wbr>Desktop<wbr>Helper<wbr>Encrypt<wbr>Storage</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class">
						<li class="tsd-signature tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Encrypt<wbr>Storage<span class="tsd-signature-symbol">(</span>key<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a>, decryptedStoragePayload<span class="tsd-signature-symbol">: </span><a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a>, storageValueStore<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../modules/protocol_payloads_generator.html#rawpayload" class="tsd-signature-type" data-tsd-kind="Type alias">RawPayload</a><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L265">migrations/2_0_0.ts:265</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Helper
										Web/desktop only
									Encrypt storage with account key</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>key: <a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a></h5>
								</li>
								<li>
									<h5>decryptedStoragePayload: <a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a></h5>
								</li>
								<li>
									<h5>storageValueStore: <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../modules/protocol_payloads_generator.html#rawpayload" class="tsd-signature-type" data-tsd-kind="Type alias">RawPayload</a><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="webdesktophelperextractandwrapaccountkeysfromvaluestore" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> web<wbr>Desktop<wbr>Helper<wbr>Extract<wbr>And<wbr>Wrap<wbr>Account<wbr>Keys<wbr>From<wbr>Value<wbr>Store</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Extract<wbr>And<wbr>Wrap<wbr>Account<wbr>Keys<wbr>From<wbr>Value<wbr>Store<span class="tsd-signature-symbol">(</span>passcodeKey<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a>, accountKeyParams<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span>, storageValueStore<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{ </span>accountKey<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a><span class="tsd-signature-symbol">; </span>wrappedKey<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol"> | </span><a href="../modules/protocol_payloads_generator.html#rawpayload" class="tsd-signature-type" data-tsd-kind="Type alias">RawPayload</a><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L224">migrations/2_0_0.ts:224</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Helper
									Web/desktop only</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>passcodeKey: <a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a></h5>
								</li>
								<li>
									<h5>accountKeyParams: <span class="tsd-signature-type">any</span></h5>
								</li>
								<li>
									<h5>storageValueStore: <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{ </span>accountKey<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a><span class="tsd-signature-symbol">; </span>wrappedKey<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol"> | </span><a href="../modules/protocol_payloads_generator.html#rawpayload" class="tsd-signature-type" data-tsd-kind="Type alias">RawPayload</a><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-private">
					<a name="webdesktophelpergetpasscodekeyanddecryptencryptedstorage" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagPrivate">Private</span> web<wbr>Desktop<wbr>Helper<wbr>Get<wbr>Passcode<wbr>Key<wbr>And<wbr>Decrypt<wbr>Encrypted<wbr>Storage</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-private">
						<li class="tsd-signature tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Get<wbr>Passcode<wbr>Key<wbr>And<wbr>Decrypt<wbr>Encrypted<wbr>Storage<span class="tsd-signature-symbol">(</span>encryptedPayload<span class="tsd-signature-symbol">: </span><a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{ </span>decryptedStoragePayload<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol"> | </span><a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a><span class="tsd-signature-symbol">; </span>key<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a><span class="tsd-signature-symbol">; </span>keyParams<span class="tsd-signature-symbol">: </span><a href="protocol_key_params.snrootkeyparams.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKeyParams</a><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L193">migrations/2_0_0.ts:193</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Helper
									Web/desktop only</p>
								</div>
							</div>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>encryptedPayload: <a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{ </span>decryptedStoragePayload<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol"> | </span><a href="protocol_payloads_pure_payload.purepayload.html" class="tsd-signature-type" data-tsd-kind="Class">PurePayload</a><span class="tsd-signature-symbol">; </span>key<span class="tsd-signature-symbol">: </span><a href="protocol_root_key.snrootkey.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKey</a><span class="tsd-signature-symbol">; </span>keyParams<span class="tsd-signature-symbol">: </span><a href="protocol_key_params.snrootkeyparams.html" class="tsd-signature-type" data-tsd-kind="Class">SNRootKeyParams</a><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-static">
					<a name="version" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagStatic">Static</span> version</h3>
					<ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-static">
						<li class="tsd-signature tsd-kind-icon">version<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<p>Overrides <a href="migrations_migration.migration.html">Migration</a>.<a href="migrations_migration.migration.html#version">version</a></p>
								<ul>
									<li>Defined in <a href="https://github.com/standardnotes/snjs/blob/1584960/lib/migrations/2_0_0.ts#L55">migrations/2_0_0.ts:55</a></li>
								</ul>
							</aside>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">string</span></h4>
						</li>
					</ul>
				</section>
			</section>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="../modules.html">Exports</a>
					</li>
					<li class="current tsd-kind-module">
						<a href="../modules/migrations_2_0_0.html">migrations/2_<wbr>0_0</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
				<ul class="current">
					<li class="current tsd-kind-class tsd-parent-kind-module">
						<a href="migrations_2_0_0.migration2_0_0.html" class="tsd-kind-icon">Migration2_<wbr>0_0</a>
						<ul>
							<li class=" tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited">
								<a href="migrations_2_0_0.migration2_0_0.html#constructor" class="tsd-kind-icon">constructor</a>
							</li>
							<li class=" tsd-kind-property tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#legacyreader" class="tsd-kind-icon">legacy<wbr>Reader</a>
							</li>
							<li class=" tsd-kind-property tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
								<a href="migrations_2_0_0.migration2_0_0.html#services" class="tsd-kind-icon">services</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#allplatformhelpersetstoragestructure" class="tsd-kind-icon">all<wbr>Platform<wbr>Helper<wbr>Set<wbr>Storage<wbr>Structure</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class">
								<a href="migrations_2_0_0.migration2_0_0.html#createdefaultitemskeyforallplatforms" class="tsd-kind-icon">create<wbr>Default<wbr>Items<wbr>Key<wbr>For<wbr>All<wbr>Platforms</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class">
								<a href="migrations_2_0_0.migration2_0_0.html#deletelegacystoragevalues" class="tsd-kind-icon">delete<wbr>Legacy<wbr>Storage<wbr>Values</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#getfallbackrootkeyversion" class="tsd-kind-icon">get<wbr>Fallback<wbr>Root<wbr>Key<wbr>Version</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
								<a href="migrations_2_0_0.migration2_0_0.html#handlestage" class="tsd-kind-icon">handle<wbr>Stage</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
								<a href="migrations_2_0_0.migration2_0_0.html#markdone" class="tsd-kind-icon">mark<wbr>Done</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#migratearbitraryrawstoragetomanagedstorageallplatforms" class="tsd-kind-icon">migrate<wbr>Arbitrary<wbr>Raw<wbr>Storage<wbr>ToManaged<wbr>Storage<wbr>All<wbr>Platforms</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#migratemobilepreferences" class="tsd-kind-icon">migrate<wbr>Mobile<wbr>Preferences</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#migratesessionstorage" class="tsd-kind-icon">migrate<wbr>Session<wbr>Storage</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class">
								<a href="migrations_2_0_0.migration2_0_0.html#migratestoragestructureformobile" class="tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Mobile</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#migratestoragestructureforwebdesktop" class="tsd-kind-icon">migrate<wbr>Storage<wbr>Structure<wbr>For<wbr>Web<wbr>Desktop</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-inherited">
								<a href="migrations_2_0_0.migration2_0_0.html#ondone" class="tsd-kind-icon">on<wbr>Done</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
								<a href="migrations_2_0_0.migration2_0_0.html#promptforpasscodeuntilcorrect" class="tsd-kind-icon">prompt<wbr>For<wbr>Passcode<wbr>Until<wbr>Correct</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-inherited tsd-is-protected">
								<a href="migrations_2_0_0.migration2_0_0.html#registerstagehandler" class="tsd-kind-icon">register<wbr>Stage<wbr>Handler</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-protected">
								<a href="migrations_2_0_0.migration2_0_0.html#registerstagehandlers" class="tsd-kind-icon">register<wbr>Stage<wbr>Handlers</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class">
								<a href="migrations_2_0_0.migration2_0_0.html#webdesktophelperencryptstorage" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Encrypt<wbr>Storage</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#webdesktophelperextractandwrapaccountkeysfromvaluestore" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Extract<wbr>And<wbr>Wrap<wbr>Account<wbr>Keys<wbr>From<wbr>Value<wbr>Store</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-private">
								<a href="migrations_2_0_0.migration2_0_0.html#webdesktophelpergetpasscodekeyanddecryptencryptedstorage" class="tsd-kind-icon">web<wbr>Desktop<wbr>Helper<wbr>Get<wbr>Passcode<wbr>Key<wbr>And<wbr>Decrypt<wbr>Encrypted<wbr>Storage</a>
							</li>
							<li class=" tsd-kind-method tsd-parent-kind-class tsd-is-overwrite tsd-is-static">
								<a href="migrations_2_0_0.migration2_0_0.html#version" class="tsd-kind-icon">version</a>
							</li>
						</ul>
					</li>
				</ul>
				<ul class="after-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../assets/js/main.js"></script>
</body>
</html>